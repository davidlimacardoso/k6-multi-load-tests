#!/bin/bash

TOKEN="YWRtaW46YWRtaW5UZXN0ZXJASzY="

echo "#######################################################"
echo "Create InfluxDB connector..."
echo 

curl -X POST http://localhost:3000/api/datasources \
  -H "Content-Type: application/json" \
  -H "Authorization: Basic $TOKEN" \
  -d '{
    "name": "influxdb",
    "type": "influxdb",
    "typeLogoUrl": "public/app/plugins/datasource/influxdb/img/influxdb_logo.svg",
    "access": "proxy",
    "url": "http://influxdb:8086",
    "user": "",
    "database": "",
    "basicAuth": false,
    "basicAuthUser": "",
    "withCredentials": false,
    "isDefault": true,
    "jsonData": {
        "dbName": "k6"
    },
    "secureJsonFields": {},
    "version": 2,
    "readOnly": false,
    "accessControl": {
        "alert.instances.external:read": true,
        "alert.instances.external:write": true,
        "alert.notifications.external:read": true,
        "alert.notifications.external:write": true,
        "alert.rules.external:read": true,
        "alert.rules.external:write": true,
        "datasources.id:read": true,
        "datasources:delete": true,
        "datasources:query": true,
        "datasources:read": true,
        "datasources:write": true
    },
    "apiVersion": ""
}'

echo
echo "#######################################################"
echo 
echo "Import dashboard K6 Load Test..."
echo 


curl -X POST http://localhost:3000/api/dashboards/import \
  	-H "Content-Type: application/json" \
  	-H "Authorization: Basic $TOKEN" \
    -d '{"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":{"type":"grafana","uid":"-- Grafana --"},"enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"description":"Sight of the tests executed in K6","editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":null,"links":[],"panels":[{"datasource":{"type":"influxdb"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"bars","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"short"},"overrides":[]},"gridPos":{"h":12,"w":17,"x":0,"y":0},"id":299,"interval":"10s","options":{"alertThreshold":true,"legend":{"calcs":["sum"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"single","sort":"none"}},"pluginVersion":"11.3.0","targets":[{"datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["group::tag"],"type":"tag"},{"params":["none"],"type":"fill"}],"measurement":"http_reqs","orderByTime":"ASC","policy":"default","query":"SELECT sum(\"value\") FROM \"http_reqs\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":false,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"sum"}]],"tags":[]}],"title":"Requests per 10s","transformations":[{"id":"renameByRegex","options":{"regex":".*group: ::([^}]*)}.*","renamePattern":"$1"}}],"type":"timeseries"},{"datasource":{"type":"influxdb"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"bars","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"short"},"overrides":[]},"gridPos":{"h":12,"w":7,"x":17,"y":0},"id":244,"interval":"1m","options":{"alertThreshold":true,"legend":{"calcs":["sum"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"desc"}},"pluginVersion":"11.3.0","targets":[{"datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["none"],"type":"fill"}],"measurement":"http_reqs","orderByTime":"ASC","policy":"default","query":"SELECT sum(\"value\") FROM \"http_reqs\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":false,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"sum"}]],"tags":[]}],"title":"Requests per Minute","transformations":[{"id":"renameByRegex","options":{"regex":".*group: ::([^}]*)}.*","renamePattern":"$1"}}],"type":"timeseries"},{"datasource":{"type":"influxdb"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"bars","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"short"},"overrides":[]},"gridPos":{"h":10,"w":13,"x":0,"y":12},"id":355,"interval":"30s","options":{"legend":{"calcs":["sum"],"displayMode":"table","placement":"right","showLegend":true,"sortBy":"Total","sortDesc":true},"tooltip":{"mode":"single","sort":"desc"}},"pluginVersion":"11.3.0","targets":[{"datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["group::tag"],"type":"tag"},{"params":["status::tag"],"type":"tag"},{"params":["none"],"type":"fill"}],"measurement":"http_reqs","orderByTime":"ASC","policy":"default","query":"SELECT sum(\"value\") FROM \"http_reqs\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":false,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"sum"}]],"tags":[{"key":"expected_response::tag","operator":"=","value":"false"}]}],"title":"Errors per Group","transformations":[{"id":"renameByRegex","options":{"regex":".*group: ::([^}]*)}.*","renamePattern":"$1"}}],"type":"timeseries"},{"datasource":{"type":"influxdb"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","axisWidth":1,"barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"noValue":"0","thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"none"},"overrides":[]},"gridPos":{"h":10,"w":11,"x":13,"y":12},"id":133,"interval":"5","maxDataPoints":1000,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"right","showLegend":true},"tooltip":{"mode":"single","sort":"none"}},"pluginVersion":"11.3.0","targets":[{"alias":"","datasource":{"type":"influxdb"},"groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"measurement":"/^$Measurement$/","orderByTime":"ASC","policy":"autogen","query":"SELECT sum(value) FROM \"http_reqs\" WHERE $timeFilter GROUP BY time($__interval), \"status\"::tag fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"count"}]],"tags":[{"key":"group::tag","operator":"=","value":"::Customer Search"}]}],"title":"Requests by Status Code","transformations":[{"id":"renameByRegex","options":{"regex":".*status: ([^}]*)}.*","renamePattern":"status: $1"}}],"type":"timeseries"},{"datasource":{"type":"influxdb"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"align":"auto","cellOptions":{"type":"auto"},"inspect":true},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"#EAB839","value":""}]}},"overrides":[{"matcher":{"id":"byName","options":"name"},"properties":[{"id":"custom.width","value":423}]},{"matcher":{"id":"byName","options":"error_code"},"properties":[{"id":"custom.width","value":21}]},{"matcher":{"id":"byName","options":"url"},"properties":[{"id":"custom.width","value":714}]},{"matcher":{"id":"byName","options":"Time"},"properties":[{"id":"custom.width","value":164}]},{"matcher":{"id":"byName","options":"status"},"properties":[{"id":"custom.width","value":69}]},{"matcher":{"id":"byName","options":"expected_response"},"properties":[{"id":"custom.width","value":78}]},{"matcher":{"id":"byName","options":"group"},"properties":[{"id":"custom.width","value":340}]},{"matcher":{"id":"byName","options":"method"},"properties":[{"id":"custom.width","value":71}]}]},"gridPos":{"h":8,"w":24,"x":0,"y":22},"id":76,"interval":"5","maxDataPoints":1000,"options":{"cellHeight":"sm","footer":{"countRows":false,"fields":"","reducer":["sum"],"show":false},"frameIndex":0,"showHeader":true,"sortBy":[{"desc":true,"displayName":"status"}]},"pluginVersion":"11.3.0","targets":[{"datasource":{"type":"influxdb"},"groupBy":[],"hide":false,"measurement":"http_reqs","orderByTime":"DESC","policy":"default","query":"SELECT \"method\", \"status\", \"url\", \"group\" \nFROM \"http_req_failed\" \nWHERE $timeFilter \nORDER BY time DESC","rawQuery":true,"refId":"A","resultFormat":"table","select":[[{"params":["url"],"type":"field"}]],"tags":[]}],"title":"Request Failed","transformations":[{"id":"filterByValue","options":{"filters":[{"config":{"id":"regex","options":{"value":"\\b(2[0-9]{2})\\b"}},"fieldName":"status"}],"match":"all","type":"exclude"}}],"type":"table"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":30},"id":19,"panels":[],"repeat":"Measurement","title":"$Measurement","type":"row"},{"datasource":{"type":"influxdb"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"ms"},"overrides":[]},"gridPos":{"h":3,"w":4,"x":0,"y":31},"id":11,"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"horizontal","percentChangeColorMode":"standard","reduceOptions":{"calcs":["mean"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.3.0","targets":[{"datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"orderByTime":"ASC","policy":"default","query":"SELECT mean(\"value\") FROM $Measurement WHERE $timeFilter ","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"title":"$Measurement (mean)","type":"stat"},{"datasource":{"type":"influxdb"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"ms"},"overrides":[]},"gridPos":{"h":3,"w":4,"x":4,"y":31},"id":14,"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"horizontal","percentChangeColorMode":"standard","reduceOptions":{"calcs":["mean"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.3.0","targets":[{"datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"orderByTime":"ASC","policy":"default","query":"SELECT max(\"value\") FROM $Measurement WHERE $timeFilter","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"title":"$Measurement (max)","type":"stat"},{"datasource":{"type":"influxdb"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"ms"},"overrides":[]},"gridPos":{"h":3,"w":4,"x":8,"y":31},"id":15,"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"horizontal","percentChangeColorMode":"standard","reduceOptions":{"calcs":["mean"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.3.0","targets":[{"datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"orderByTime":"ASC","policy":"default","query":"SELECT median(\"value\") FROM $Measurement WHERE $timeFilter","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"title":"$Measurement (med)","type":"stat"},{"datasource":{"type":"influxdb"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"ms"},"overrides":[]},"gridPos":{"h":3,"w":4,"x":12,"y":31},"id":16,"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"horizontal","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.3.0","targets":[{"datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"orderByTime":"ASC","policy":"default","query":"SELECT min(\"value\") FROM $Measurement WHERE $timeFilter and value > 0","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"title":"$Measurement (min)","type":"stat"},{"datasource":{"type":"influxdb"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"ms"},"overrides":[]},"gridPos":{"h":3,"w":4,"x":16,"y":31},"id":12,"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"horizontal","percentChangeColorMode":"standard","reduceOptions":{"calcs":["mean"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.3.0","targets":[{"datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"orderByTime":"ASC","policy":"default","query":"SELECT percentile(\"value\", 90) FROM $Measurement WHERE $timeFilter","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"title":"$Measurement (p90)","type":"stat"},{"datasource":{"type":"influxdb"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"ms"},"overrides":[]},"gridPos":{"h":3,"w":4,"x":20,"y":31},"id":13,"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"horizontal","percentChangeColorMode":"standard","reduceOptions":{"calcs":["mean"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.3.0","targets":[{"datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"orderByTime":"ASC","policy":"default","query":"SELECT percentile(\"value\", 95) FROM $Measurement WHERE $timeFilter ","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"title":"$Measurement (p95)","type":"stat"},{"datasource":{"type":"influxdb"},"description":"Grouped by 1 sec intervals","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":5,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineStyle":{"fill":"solid"},"lineWidth":1,"pointSize":5,"scaleDistribution":{"log":2,"type":"log"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"dashed"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"#EAB839","value":10000},{"color":"dark-red","value":30000}]},"unit":"ms"},"overrides":[]},"gridPos":{"h":7,"w":12,"x":0,"y":34},"id":5,"interval":">1s","options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"11.3.0","targets":[{"alias":"max","datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["none"],"type":"fill"}],"measurement":"/^$Measurement$/","orderByTime":"ASC","policy":"default","query":"SELECT max(\"value\") FROM /^$Measurement$/ WHERE $timeFilter and value > 0 GROUP BY time($__interval) fill(none)","rawQuery":true,"refId":"C","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"max"}]],"tags":[]},{"alias":"p95","datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["none"],"type":"fill"}],"measurement":"/^$Measurement$/","orderByTime":"ASC","policy":"default","query":"SELECT percentile(\"value\", 95) FROM /^$Measurement$/ WHERE $timeFilter and value > 0 GROUP BY time($__interval) fill(none)","rawQuery":true,"refId":"D","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[95],"type":"percentile"}]],"tags":[]},{"alias":"p90","datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["none"],"type":"fill"}],"measurement":"/^$Measurement$/","orderByTime":"ASC","policy":"default","query":"SELECT percentile(\"value\", 90) FROM /^$Measurement$/ WHERE $timeFilter and value > 0 GROUP BY time($__interval) fill(none)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":["90"],"type":"percentile"}]],"tags":[]},{"alias":"min","datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["none"],"type":"fill"}],"measurement":"/^$Measurement$/","orderByTime":"ASC","policy":"default","query":"SELECT min(\"value\") FROM /^$Measurement$/ WHERE $timeFilter and value > 0 GROUP BY time($__interval) fill(none)","rawQuery":true,"refId":"E","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"min"}]],"tags":[]}],"title":"$Measurement (over time)","type":"timeseries"},{"datasource":{"type":"influxdb"},"description":"Grouped by 1 sec intervals","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineStyle":{"fill":"solid"},"lineWidth":1,"pointSize":5,"scaleDistribution":{"log":2,"type":"symlog"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"dashed"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"#EAB839","value":10000},{"color":"dark-red","value":25000}]},"unit":"ms"},"overrides":[]},"gridPos":{"h":7,"w":12,"x":12,"y":34},"id":404,"interval":">1s","options":{"legend":{"calcs":[],"displayMode":"table","placement":"bottom","showLegend":false},"tooltip":{"mode":"single","sort":"none"}},"pluginVersion":"11.3.0","targets":[{"alias":"max","datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["none"],"type":"fill"}],"hide":true,"measurement":"/^$Measurement$/","orderByTime":"ASC","policy":"default","query":"SELECT max(\"value\") FROM /^$Measurement$/ WHERE $timeFilter and value > 0 GROUP BY time($__interval) fill(none)","rawQuery":true,"refId":"C","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"max"}]],"tags":[]},{"alias":"p95","datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["none"],"type":"fill"}],"hide":true,"measurement":"/^$Measurement$/","orderByTime":"ASC","policy":"default","query":"SELECT percentile(\"value\", 95) FROM /^$Measurement$/ WHERE $timeFilter and value > 0 GROUP BY time($__interval) fill(none)","rawQuery":true,"refId":"D","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[95],"type":"percentile"}]],"tags":[]},{"datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["group::tag"],"type":"tag"},{"params":["none"],"type":"fill"}],"measurement":"/^$Measurement$/","orderByTime":"ASC","policy":"default","query":"SELECT percentile(\"value\", 90) FROM /^$Measurement$/ WHERE $timeFilter and value > 0 GROUP BY time($__interval) fill(none)","rawQuery":false,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":["90"],"type":"percentile"}]],"tags":[]},{"alias":"min","datasource":{"type":"influxdb"},"dsType":"influxdb","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["none"],"type":"fill"}],"hide":true,"measurement":"/^$Measurement$/","orderByTime":"ASC","policy":"default","query":"SELECT min(\"value\") FROM /^$Measurement$/ WHERE $timeFilter and value > 0 GROUP BY time($__interval) fill(none)","rawQuery":true,"refId":"E","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"min"}]],"tags":[]}],"title":"$Measurement (over time)","transformations":[{"id":"renameByRegex","options":{"regex":".*group: ::([^}]*)}.*","renamePattern":"$1"}}],"type":"timeseries"}],"preload":false,"refresh":"5s","schemaVersion":40,"tags":[],"templating":{"list":[{"current":{"text":["$__all"],"value":["$__all"]},"includeAll":true,"multi":true,"name":"Measurement","options":[{"selected":false,"text":"http_req_duration","value":"http_req_duration"},{"selected":false,"text":"http_req_blocked","value":"http_req_blocked"},{"selected":false,"text":"http_req_connecting","value":"http_req_connecting"},{"selected":false,"text":"http_req_looking_up","value":"http_req_looking_up"},{"selected":false,"text":"http_req_receiving","value":"http_req_receiving"},{"selected":false,"text":"http_req_sending","value":"http_req_sending"},{"selected":false,"text":"http_req_waiting","value":"http_req_waiting"}],"query":"http_req_duration,http_req_blocked,http_req_connecting,http_req_looking_up,http_req_receiving,http_req_sending,http_req_waiting","type":"custom"}]},"time":{"from":"now-3h","to":"now"},"timepicker":{},"timezone":"browser","title":"K6 Test Load","version":3,"weekStart":""},"overwrite":true,"inputs":[],"folderUid":""}'


echo "#######################################################"
